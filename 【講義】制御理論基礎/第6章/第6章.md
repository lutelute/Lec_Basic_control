

# 状態空間表現
> **State-Space Representation**

## **1. 概要**
**状態空間表現 (State-Space Representation)** とは、LTI (線形時不変) システムの内部状態を考慮し、行列形式で記述する手法である。  
従来の伝達関数やインパルス応答は**入出力関係のみ**を表現する**外部記述**であるのに対し、状態空間表現は**システムの内部状態を含めた表現**（**内部記述**）となる。

状態空間表現を利用することで、**多入力多出力 (MIMO) システムの解析や制御系設計**が容易になり、現代制御理論の基盤となる。

---

## **2. 状態空間表現の基本式**
LTI システムの状態空間表現は、次の **状態方程式** と **出力方程式** で表される。

### **(1) 状態方程式 (State Equation)**
$$
\frac{dx(t)}{dt} = A x(t) + B u(t)
$$

- \( x(t) \) : **状態変数ベクトル (State Vector)**（システムの内部状態）
- \( u(t) \) : **入力ベクトル (Input Vector)**
- \( A \) : **状態行列 (State Matrix)**
- \( B \) : **入力行列 (Input Matrix)**

### **(2) 出力方程式 (Output Equation)**
$$
y(t) = C x(t) + D u(t)
$$

- \( y(t) \) : **出力ベクトル (Output Vector)**
- \( C \) : **出力行列 (Output Matrix)**
- \( D \) : **直達項 (Direct Transmission Term)**（入力が直接出力に影響を与える場合）

この形式は、**n次の微分方程式を1階の行列微分方程式に変換する**手法として利用される。

---

## **3. 状態空間表現の導出**
### **(1) 質点の運動方程式の例**
質量 \( m \) の物体に外力 \( u(t) \) が加わる場合、運動方程式は以下のようになる：

$$
m \frac{d^2 y(t)}{dt^2} = u(t)
$$

これを状態空間表現に変換するため、状態変数を次のように定義する：
- **位置 \( x_1(t) = y(t) \)**
- **速度 \( x_2(t) = \frac{dy(t)}{dt} \)**

これを用いると、状態方程式は次の形に変形できる：

$$
\begin{aligned}
\frac{dx_1}{dt} &= x_2 \\
\frac{dx_2}{dt} &= \frac{1}{m} u(t)
\end{aligned}
$$

行列形式にすると：

$$
\begin{bmatrix}
\frac{dx_1}{dt} \\
\frac{dx_2}{dt}
\end{bmatrix}
=
\begin{bmatrix}
0 & 1 \\
0 & 0
\end{bmatrix}
\begin{bmatrix}
x_1 \\
x_2
\end{bmatrix}
+
\begin{bmatrix}
0 \\
\frac{1}{m}
\end{bmatrix}
u(t)
$$

出力が位置 \( y(t) = x_1(t) \) の場合、出力方程式は：

$$
y(t) =
\begin{bmatrix}
1 & 0
\end{bmatrix}
\begin{bmatrix}
x_1 \\
x_2
\end{bmatrix}
+ 0 \cdot u(t)
$$

---

## **4. 状態空間表現と伝達関数の関係**
状態空間表現から伝達関数 \( G(s) \) は次の式で求められる：

$$
G(s) = C (sI - A)^{-1} B + D
$$

ここで、
- \( (sI - A)^{-1} \) は行列の逆行列（リゾルベント行列）
- **極 (Poles)** は行列 \( A \) の固有値

この関係から、**状態空間表現と伝達関数は等価であり、相互に変換可能** である。

---

## **5. 状態空間表現の応用**
- **現代制御理論 (Modern Control Theory)** の基礎
- **カルマンフィルタ (Kalman Filter)** による状態推定
- **ロバスト制御 (Robust Control)**
- **多入力多出力 (MIMO) システムの解析**
- **最適制御 (Optimal Control)**

---

## **6. 状態空間表現の特徴**
### **(1) システムの次元**
状態ベクトルの次元 \( n \) は、元のシステムの**微分方程式の次数**と一致する。

### **(2) 代数的に等価なシステム**
正則変換行列 \( T \) によって状態ベクトルを変換しても、伝達関数は変化しない：

$$
z(t) = T^{-1} x(t)
$$

このような変換を行っても、**システムの本質的な挙動は変わらない**。

---

## **7. 状態遷移行列**
状態遷移行列 \( \Phi(t) \) は、状態方程式の解を求めるための行列であり、次のように定義される：

$$
\Phi(t) = e^{At}
$$

これにより、初期状態 \( x_0 \) からの解は：

$$
x(t) = \Phi(t) x_0 + \int_0^t \Phi(t-\tau) B u(\tau) d\tau
$$

---

## **8. 演習問題**
### **問題1: 状態空間表現の導出**
次の微分方程式を状態空間表現に変換せよ。
$$
\frac{d^2 y}{dt^2} + 3 \frac{dy}{dt} + 2y = u(t)
$$

### **問題2: 状態空間表現と伝達関数**
以下の状態空間表現に対して伝達関数 \( G(s) \) を求めよ。
$$
A =
\begin{bmatrix}
0 & 1 \\
-2 & -3
\end{bmatrix},
\quad B =
\begin{bmatrix}
0 \\
1
\end{bmatrix},
\quad C =
\begin{bmatrix}
1 & 0
\end{bmatrix},
\quad D = 0
$$

### **問題3: 状態遷移行列の計算**
行列 \( A \) が次のとき、状態遷移行列 \( e^{At} \) を求めよ。
$$
A =
\begin{bmatrix}
0 & 1 \\
-1 & -2
\end{bmatrix}
$$

---

このノートを **Obsidian** に保存すると、そのまま綺麗に表示されます。  
必要に応じて修正・追加できますので、お知らせください。